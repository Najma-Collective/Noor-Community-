<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B2 Final Assessment: Strategic Planning in the NGO Sector</title>

    <!-- 1. Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Questrial&display=swap" rel="stylesheet">

    <!-- 2. Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <!-- 3. Embedded CSS Theme from Reference Implementation -->
    <style>
        /* =====================================================================
           Noor Community Activities â€” Enhanced UI System
           Refined version of the Organic Sage visual language.
           ===================================================================== */

        /* -------------------------------
           Design Tokens
        ----------------------------------*/
        :root {
          /* Core Palette */
          --primary-sage: #7a8471;
          --secondary-sage: #9caf88;
          --tertiary-sage: #b8c5a6;
          --warm-cream: #f8f6f0;
          --soft-white: #fefcf7;
          --forest-shadow: #5a6b52;
          --ink: #2f3a2b;
          --ink-muted: #5a6b52;
          --border-sage: rgba(122, 132, 113, 0.2);
          --hover-sage: rgba(156, 175, 136, 0.15);

          /* Extended Palette */
          --deep-forest: #3e4a3a;
          --moss: #6e7a67;
          --amber: #c6aa77;

          /* Typography */
          --font-display: "Questrial", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
          --font-body: "Nunito", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
          --font-size-adjustment: 0rem;
          --step--1: calc(clamp(0.875rem, 0.82rem + 0.18vw, 0.95rem) + var(--font-size-adjustment));
          --step-0:  calc(clamp(1rem, 0.94rem + 0.28vw, 1.1rem) + var(--font-size-adjustment));
          --step-1:  calc(clamp(1.125rem, 1.04rem + 0.42vw, 1.32rem) + var(--font-size-adjustment));
          --step-2:  calc(clamp(1.35rem, 1.18rem + 0.68vw, 1.65rem) + var(--font-size-adjustment));
          --step-3:  calc(clamp(1.75rem, 1.42rem + 1.1vw, 2.1rem) + var(--font-size-adjustment));
          --step-4:  calc(clamp(2.25rem, 1.8rem + 1.65vw, 2.75rem) + var(--font-size-adjustment));

          /* Rhythm & Spacing */
          --space-1: 0.25rem;
          --space-2: 0.5rem;
          --space-3: 0.75rem;
          --space-4: 1rem;
          --space-5: 1.25rem;
          --space-6: 1.5rem;
          --space-7: 2rem;
          --space-8: 2.5rem;
          --space-9: 3rem;

          /* Shape & Elevation */
          --radius-sm: 10px;
          --radius: 16px;
          --radius-lg: 20px;
          --radius-xl: 28px;
          --shadow-1: 0 1px 2px rgba(34, 41, 32, 0.05), 0 2px 8px rgba(34, 41, 32, 0.06);
          --shadow-2: 0 4px 18px rgba(34, 41, 32, 0.08), 0 12px 28px rgba(34, 41, 32, 0.06);
          --shadow-3: 0 10px 40px rgba(34, 41, 32, 0.1), 0 20px 60px rgba(34, 41, 32, 0.08);
          --ring: 0 0 0 3px color-mix(in oklab, var(--soft-white) 60%, transparent),
                   0 0 0 5px color-mix(in srgb, var(--secondary-sage) 85%, #2f3a2b 15%);

          /* Motion */
          --ease-out: cubic-bezier(.2,.8,.2,1);
          --transition-fast: 150ms var(--ease-out);
          --transition-std: 250ms var(--ease-out);

          /* Layout */
          --target-min: 44px;
          --container-max: clamp(320px, 92vw, 940px);
          --container-padding: clamp(1.25rem, 5vw, 2rem);
        }

        /* -------------------------------
           Global Reset & Base Styles
        ----------------------------------*/
        *, *::before, *::after { box-sizing: border-box; }
        html { text-size-adjust: 100%; scroll-behavior: smooth; }
        body { margin: 0; min-height: 100dvh; font-family: var(--font-body); font-size: var(--step-0); line-height: 1.6; color: var(--ink); background: var(--warm-cream); -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; overflow-x: hidden; }
        :where(p, h1, h2, h3, h4, h5, h6) { text-wrap: pretty; overflow-wrap: break-word; }
        :where(h1, h2, h3) { text-wrap: balance; }

        /* -------------------------------
           Typography & Layout
        ----------------------------------*/
        .container { width: 100%; max-width: var(--container-max); margin: 0 auto; padding: 0 var(--container-padding); }
        h1 { font-family: var(--font-display); font-size: var(--step-4); color: var(--forest-shadow); text-align: center; line-height: 1.1; margin: 0 0 var(--space-3); }
        h2 { font-family: var(--font-display); font-size: var(--step-3); color: var(--forest-shadow); margin: var(--space-7) 0 var(--space-4); }
        h3 { font-family: var(--font-display); font-size: var(--step-2); color: var(--forest-shadow); margin: 0 0 var(--space-3); letter-spacing: 0.02em; }
        
        /* -------------------------------
           Buttons
        ----------------------------------*/
        .activity-btn { min-height: var(--target-min); padding: 0.75rem clamp(1.2rem, 4vw, 1.75rem); border-radius: 999px; border: 1px solid color-mix(in srgb, var(--primary-sage) 65%, #fff 35%); background: linear-gradient(180deg, var(--primary-sage), var(--deep-forest)); color: #fff; font-weight: 700; font-size: var(--step-0); letter-spacing: 0.08em; text-transform: uppercase; cursor: pointer; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; gap: 0.6rem; -webkit-tap-highlight-color: transparent; transition: transform var(--transition-fast), box-shadow var(--transition-std), background var(--transition-std); box-shadow: var(--shadow-1); }
        .activity-btn:hover { transform: scale(1.02); box-shadow: var(--shadow-2); background: linear-gradient(180deg, var(--moss), var(--deep-forest)); }
        .activity-btn:active { transform: scale(0.98); }
        .activity-btn:focus-visible { outline: none; box-shadow: var(--ring), var(--shadow-2); transform: scale(1.02); }
        .activity-btn:disabled { background: var(--tertiary-sage); border-color: color-mix(in srgb, var(--tertiary-sage) 80%, #fff 20%); color: color-mix(in srgb, #fff 85%, var(--soft-white) 15%); cursor: not-allowed; opacity: 0.85; transform: none; box-shadow: none; }

        /* -------------------------------
           Multiple Choice Question Styles
        ----------------------------------*/
        .mc-question { padding: clamp(1.25rem, 4vw, 1.75rem); border-radius: var(--radius); border: 1px solid var(--border-sage); background: linear-gradient(180deg, #fff, color-mix(in srgb, #fff 90%, var(--warm-cream) 10%)); box-shadow: var(--shadow-1); margin-bottom: var(--space-6); }
        .mc-question-text { font-weight: 700; font-size: var(--step-1); color: var(--forest-shadow); line-height: 1.45; margin: 0 0 var(--space-5); }
        .mc-options-container { display: flex; flex-direction: column; gap: var(--space-3); }
        .mc-option-item input { display: none; }
        .mc-option-label { display: flex; align-items: center; gap: var(--space-3); cursor: pointer; padding: 0.75rem 1rem; border-radius: var(--radius-sm); border: 1px solid var(--border-sage); background: color-mix(in srgb, var(--soft-white) 92%, #fff 8%); transition: all var(--transition-std); -webkit-tap-highlight-color: transparent; }
        .mc-option-label:hover { background: var(--hover-sage); border-color: color-mix(in srgb, var(--secondary-sage) 50%, transparent); }
        .mc-option-label .option-control { flex-shrink: 0; width: 24px; height: 24px; border: 2px solid var(--tertiary-sage); background-color: var(--soft-white); transition: all var(--transition-std); position: relative; border-radius: 50%; box-shadow: inset 0 1px 0 rgba(255,255,255,0.7); }
        .mc-option-label.locked { cursor: not-allowed; background: var(--hover-sage); opacity: 0.8; }
        .mc-option-item input:checked + .mc-option-label .option-control { border-color: var(--primary-sage); background-color: var(--primary-sage); }
        .mc-option-item input:checked + .mc-option-label .option-control::after { content: ''; position: absolute; inset: 4px; border-radius: 50%; background-color: #fff; }
        .mc-option-item input:focus-visible + .mc-option-label { outline: none; box-shadow: var(--ring); }
        .mc-option-label:has(input:checked) { border-color: var(--primary-sage); background: color-mix(in srgb, var(--hover-sage) 30%, #fff 70%); }
        .mc-option-label:has(input:checked) .mc-option-text { color: var(--deep-forest); font-weight: 600; }

        /* -------------------------------
           Assessment-Specific Custom Styles
        ----------------------------------*/
        .assessment-container { display: none; padding-top: 4.5rem; }
        #student-id-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); display: flex; justify-content: center; align-items: center; z-index: 1000; }
        #student-id-box { background: var(--soft-white); padding: var(--space-8); border-radius: var(--radius-lg); text-align: center; box-shadow: var(--shadow-3); width: 90%; max-width: 400px; }
        #student-id-box h2 { margin-top: 0; color: var(--primary-sage); font-family: var(--font-display); }
        #student-id-input { width: 100%; padding: var(--space-3); margin: var(--space-5) 0; border: 1px solid var(--border-sage); border-radius: var(--radius-sm); font-size: var(--step-0); }

        .timer-bar { position: fixed; top: 0; left: 0; width: 100%; background-color: var(--deep-forest); color: var(--soft-white); padding: var(--space-3) var(--space-4); text-align: center; font-weight: 700; z-index: 999; box-shadow: var(--shadow-2); }
        #countdown-timer { background-color: var(--amber); color: var(--deep-forest); padding: var(--space-1) var(--space-2); border-radius: 6px; margin-left: var(--space-2); }
        
        .hero-section { position: relative; background-size: cover; background-position: center; padding: clamp(3rem, 10vw, 6rem) 1.5rem; text-align: center; color: white; }
        .hero-overlay { position: absolute; inset: 0; background-color: rgba(0, 0, 0, 0.5); }
        .hero-content { position: relative; z-index: 2; }
        .hero-section h1 { color: white; font-size: var(--step-4); }
        .pills { display: flex; justify-content: center; gap: var(--space-3); margin-top: var(--space-4); flex-wrap: wrap; }
        .pill { display: inline-block; padding: var(--space-2) var(--space-4); border-radius: 999px; font-size: var(--step--1); font-weight: 600; background-color: rgba(255, 255, 255, 0.15); border: 1px solid rgba(255, 255, 255, 0.2); backdrop-filter: blur(5px); }
        
        .assessment-section { margin-bottom: var(--space-8); }
        .instructions { color: var(--ink-muted); font-style: italic; text-align: center; margin-bottom: var(--space-6); }
        .activity-card { background: var(--soft-white); border-radius: var(--radius); padding: var(--space-6); margin-bottom: var(--space-6); box-shadow: var(--shadow-1); border: 1px solid var(--border-sage); }
        .activity-card h3 { color: var(--primary-sage); margin-top: 0; border-bottom: 2px solid var(--hover-sage); padding-bottom: var(--space-2); font-size: var(--step-2); }
        .reading-passage { background-color: color-mix(in srgb, var(--warm-cream) 50%, var(--soft-white) 50%); padding: var(--space-6); border-radius: var(--radius); border: 1px solid var(--border-sage); margin-bottom: var(--space-6); line-height: 1.7; }

        .dropdown-question { margin-bottom: var(--space-4); }
        .dropdown-question select { padding: var(--space-2); border-radius: var(--radius-sm); border: 1px solid var(--tertiary-sage); background-color: var(--soft-white); cursor: pointer; font-family: var(--font-body); font-size: var(--step-0); }
        
        .matching-container { display: flex; flex-direction: column; gap: var(--space-6); }
        @media (min-width: 600px) { .matching-container { flex-direction: row; justify-content: space-between; } }
        .matching-column { width: 100%; }
        @media (min-width: 600px) { .matching-column { width: 48%; } }
        .matching-column ul { list-style: none; padding: 0; margin: 0; }
        .matching-column li { padding: var(--space-3); border: 1px solid var(--border-sage); border-radius: var(--radius-sm); margin-bottom: var(--space-2); cursor: pointer; transition: background-color var(--transition-std), color var(--transition-std); }
        .matching-column li:hover { background-color: var(--hover-sage); }
        .matching-column li.selected { background-color: var(--amber); color: var(--deep-forest); border-color: var(--amber); }

        .matching-column li.matched-pair-1 { background-color: #f9c74f; color: #57451b; border-color: #57451b; }
        .matching-column li.matched-pair-2 { background-color: #90be6d; color: #283618; border-color: #283618; }
        .matching-column li.matched-pair-3 { background-color: #b5a3c8; color: #3e324d; border-color: #3e324d; }
        .matching-column li.matched-pair-4 { background-color: #e5989b; color: #5e3c3d; border-color: #5e3c3d; }
        .matching-column li.matched-pair-5 { background-color: #56cfe1; color: #1a3f45; border-color: #1a3f45; }
        .matching-column li.matched-pair-6 { background-color: #fca311; color: #4d3105; border-color: #4d3105; }

        /* Click-to-Move Classification & Word Order Styles */
        .classification-container, .word-order-container { padding: var(--space-4); background-color: color-mix(in srgb, var(--warm-cream) 50%, var(--soft-white) 50%); border-radius: var(--radius); }
        .source-tokens { padding: var(--space-4); border: 2px dashed var(--tertiary-sage); border-radius: var(--radius-sm); margin-bottom: var(--space-6); display: flex; flex-wrap: wrap; gap: var(--space-2); min-height: 50px; }
        .token { padding: var(--space-2) var(--space-4); background-color: var(--soft-white); border: 1px solid var(--border-sage); border-radius: 999px; cursor: pointer; box-shadow: var(--shadow-1); transition: all var(--transition-std); }
        .token.selected { background-color: var(--amber); color: var(--deep-forest); box-shadow: var(--ring); transform: scale(1.05); }
        .drop-zones { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-4); }
        .drop-zone { padding: var(--space-4); border: 1px solid var(--border-sage); border-radius: var(--radius-sm); background-color: var(--soft-white); min-height: 100px; cursor: pointer; display: flex; flex-wrap: wrap; gap: var(--space-2); align-content: flex-start; }
        .drop-zone h4 { width: 100%; margin-top: 0; text-align: center; color: var(--primary-sage); pointer-events: none; }
        .word-order-item { margin-bottom: var(--space-6); }
        .word-order-item .drop-zone { border-style: dashed; }
        
        /* Table completion styles (adapted from classification) */
        .table-completion-container { display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4); }
        .table-header { font-weight: bold; color: var(--primary-sage); margin-bottom: var(--space-2); grid-column: 1 / -1; display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4); }
        .table-header span:first-child { grid-column: 1; text-align: right; }
        .table-header span:last-child { grid-column: 2; text-align: center; }
        .table-row { display: contents; }
        .table-row .feature-label { text-align: right; font-weight: 600; display: flex; align-items: center; justify-content: flex-end; }
        .table-row .drop-zone { min-height: 60px; justify-content: center; align-items: center; }

        /* Redesigned grant comparison cards */
        .grant-compare { display: grid; grid-template-columns: 1fr; gap: var(--space-4); }
        @media (min-width: 720px) { .grant-compare { grid-template-columns: 1fr 1fr; } }
        .grant-panel { background: color-mix(in srgb, #fff 80%, var(--warm-cream) 20%); border: 1px solid var(--border-sage); border-radius: var(--radius-lg); padding: var(--space-5); box-shadow: var(--shadow-1); display: flex; flex-direction: column; gap: var(--space-4); }
        .grant-panel h4 { margin: 0; color: var(--forest-shadow); font-size: var(--step-1); display: flex; align-items: center; gap: var(--space-2); }
        .grant-row { display: grid; grid-template-columns: 1fr; gap: var(--space-2); align-items: center; }
        @media (min-width: 540px) { .grant-row { grid-template-columns: 1fr 1.1fr; } }
        .grant-select { width: 100%; padding: var(--space-3); border-radius: var(--radius-sm); border: 1px solid var(--tertiary-sage); background-color: var(--soft-white); font-family: var(--font-body); font-size: var(--step-0); transition: border-color var(--transition-std), box-shadow var(--transition-std); }
        .grant-select:focus-visible { outline: none; box-shadow: var(--ring); border-color: var(--primary-sage); }
        .grant-select.feedback-correct { background: #d4edda; border-color: #155724; }
        .grant-select.feedback-incorrect { background: #f8d7da; border-color: #721c24; }

        /* Feedback styling */
        .feedback-correct { background-color: #d4edda !important; border-color: #c3e6cb !important; }
        .feedback-incorrect { background-color: #f8d7da !important; border-color: #f5c6cb !important; }
        .correct-answer-text { color: #155724; font-weight: bold; margin-left: var(--space-2); }
        .mc-option-label.feedback-correct { border-color: #155724 !important; background: #d4edda !important; }
        .mc-option-label.feedback-incorrect { border-color: #721c24 !important; background: #f8d7da !important; }
        .token.feedback-correct { background-color: #d4edda !important; border-color: #155724 !important; }
        .token.feedback-incorrect { background-color: #f8d7da !important; border-color: #721c24 !important; }


        #submission-area { text-align: center; margin-top: var(--space-7); }
        #submission-feedback { display: none; padding: var(--space-6); margin-top: var(--space-7); border-radius: var(--radius); text-align: center; }
        #submission-feedback.success { background-color: #d4edda; color: #155724; }
        #submission-feedback.error { background-color: #f8d7da; color: #721c24; }
    </style>
</head>
<body>

    <div id="student-id-modal">
        <div id="student-id-box">
            <h2>Final Assessment</h2>
            <p>Please enter your numeric Student ID to begin.</p>
            <input type="text" id="student-id-input" placeholder="e.g., 202412345" inputmode="numeric" pattern="[0-9]*">
            <button id="start-assessment-btn" class="activity-btn" disabled>Start Assessment</button>
        </div>
    </div>

    <div class="assessment-container">
        <div class="timer-bar">
            Time Remaining: <span id="countdown-timer">60:00</span>
        </div>

        <header class="hero-section" style="background-image: url('https://images.pexels.com/photos/66869/green-leaf-natural-wallpaper-royalty-free-66869.jpeg?auto=compress&cs=tinysrgb&h=900&w=1600');">
            <div class="hero-overlay"></div>
            <div class="hero-content container">
                <h1>Final Assessment</h1>
                <div class="pills">
                    <span class="pill">Level: B2</span>
                    <span class="pill">Unit Theme: Strategic Planning in the NGO Sector</span>
                </div>
            </div>
        </header>

        <main class="container" style="padding-top: 2rem;">

            <section class="assessment-section">
                <h2>A: Listening Comprehension</h2>
                <p class="instructions">You will listen to a dialogue between two NGO workers, Fatima and Yousef, discussing which funding stream to apply for. Listen carefully and answer the questions that follow. You will hear the audio only once.</p>
                
                <audio controls style="width: 100%; margin-bottom: 1.5rem;">
                    <source src="https://najma-collective.github.io/Noor-Community-/B2/1/EOM/download%20(13).wav" type="audio/wav">
                    Your browser does not support the audio element.
                </audio>

                <div class="activity-card">
                    <h3>Activity 1: Understanding the Discussion</h3>
                    <p class="instructions" style="text-align:left; font-style:normal;">Listen to the conversation. For each question, choose the best answer.</p>
                    <div class="mc-question" data-question-id="1.1" data-correct-answer="b">
                        <p class="mc-question-text">1. What is the main purpose of Fatima and Yousef's conversation?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q1.1" value="a" id="q1.1a"><label for="q1.1a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) To plan the content of a coding camp.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q1.1" value="b" id="q1.1b"><label for="q1.1b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) To decide which grant to apply for.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q1.1" value="c" id="q1.1c"><label for="q1.1c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) To hire a new consultant for their NGO.</span></label></div>
                        </div>
                    </div>
                    <div class="mc-question" data-question-id="1.2" data-correct-answer="c">
                        <p class="mc-question-text">2. What does Yousef see as the main advantage of the EU Culture Grant?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q1.2" value="a" id="q1.2a"><label for="q1.2a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) It has a simple application.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q1.2" value="b" id="q1.2b"><label for="q1.2b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) It is a local fund.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q1.2" value="c" id="q1.2c"><label for="q1.2c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) It offers a large amount of money.</span></label></div>
                        </div>
                    </div>
                    <div class="mc-question" data-question-id="1.3" data-correct-answer="b">
                        <p class="mc-question-text">3. According to Fatima, what is the primary disadvantage of the EU Culture Grant?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q1.3" value="a" id="q1.3a"><label for="q1.3a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) The deadline is too soon.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q1.3" value="b" id="q1.3b"><label for="q1.3b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) The application process is complicated.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q1.3" value="c" id="q1.3c"><label for="q1.3c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) The funding amount is too small.</span></label></div>
                        </div>
                    </div>
                    <div class="mc-question" data-question-id="1.4" data-correct-answer="c">
                        <p class="mc-question-text">4. What is the main problem with the Local Business Fund?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q1.4" value="a" id="q1.4a"><label for="q1.4a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) The reporting requirements are very strict.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q1.4" value="b" id="q1.4b"><label for="q1.4b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) The application is too long.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q1.4" value="c" id="q1.4c"><label for="q1.4c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) The amount of funding is insufficient.</span></label></div>
                        </div>
                    </div>
                    <div class="mc-question" data-question-id="1.5" data-correct-answer="a">
                        <p class="mc-question-text">5. What is their final decision?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q1.5" value="a" id="q1.5a"><label for="q1.5a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) They decide to apply for the EU Culture Grant.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q1.5" value="b" id="q1.5b"><label for="q1.5b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) They decide to apply for the Local Business Fund.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q1.5" value="c" id="q1.5c"><label for="q1.5c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) They decide not to apply for either grant.</span></label></div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="assessment-section">
                <h2>B: Reading Comprehension &amp; Functional Language</h2>
                <p class="instructions">Read the summaries of two different grant proposals available to an NGO in Nablus. Then, complete the activities that follow.</p>
                <div class="reading-passage">
                    <p><strong>Document 1: Grant Summaries</strong></p>
                    <p><strong>Grant A: The Al-Quds Innovation Fund (Local)</strong></p>
                    <ul>
                        <li><strong>Objective:</strong> To support youth-led projects that create a direct and measurable impact on the local Nablus economy.</li>
                        <li><strong>Funding Amount:</strong> Up to $10,000.</li>
                        <li><strong>Application Deadline:</strong> In 2 weeks.</li>
                        <li><strong>Reporting Requirements:</strong> This funding stream requires short quarterly progress reports (2 pages max). No external financial audit is necessary, which reduces the administrative burden.</li>
                        <li><strong>Focus Area:</strong> Priority is given to projects in sustainable agriculture and local crafts. Digital literacy projects are considered but must show a clear link to job creation within the city. If we applied for this, we would have to tailor our proposal significantly.</li>
                    </ul>
                    <p><strong>Grant B: The Digital Futures Foundation (International)</strong></p>
                    <ul>
                        <li><strong>Objective:</strong> To fund initiatives that align with global digital skills trends and promote remote work opportunities for youth.</li>
                        <li><strong>Funding Amount:</strong> Up to $50,000.</li>
                        <li><strong>Application Deadline:</strong> In 3 months.</li>
                        <li><strong>Reporting Requirements:</strong> Due to being an international donor, this grant demands detailed monthly reports and a full external financial audit at the end of the project timeline.</li>
                        <li><strong>Focus Area:</strong> The rationale for the project must be connected to international development goals. A partnership with a technical consultancy might strengthen the application. Our project is a perfect fit.</li>
                    </ul>
                </div>

                <div class="activity-card">
                    <h3>Activity 2: Grant Analysis</h3>
                    <p class="instructions" style="text-align:left; font-style:normal;">Read the grant summaries again. Based on the information, choose the best answer for each question.</p>

                    <div class="mc-question" data-question-id="2.1" data-correct-answer="c">
                        <p class="mc-question-text">1. An NGO has a very small team with limited experience in financial reporting. Which grant presents a higher administrative risk for them, and why?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q2.1" value="a" id="q2.1a"><label for="q2.1a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) Grant A, because the two-week deadline would pressure the small team.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q2.1" value="b" id="q2.1b"><label for="q2.1b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) Grant A, because the project needs to be tailored, creating more work.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q2.1" value="c" id="q2.1c"><label for="q2.1c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) Grant B, because it demands detailed monthly reports and a full external audit.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q2.1" value="d" id="q2.1d"><label for="q2.1d" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">d) Grant B, because international donors are always more difficult to work with.</span></label></div>
                        </div>
                    </div>

                    <div class="mc-question" data-question-id="2.2" data-correct-answer="b">
                        <p class="mc-question-text">2. Which statement best describes the primary strategic trade-off the NGO must consider?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q2.2" value="a" id="q2.2a"><label for="q2.2a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) Choosing between a focus on local crafts and a focus on remote work.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q2.2" value="b" id="q2.2b"><label for="q2.2b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) Choosing between a larger grant that requires significant administrative effort and a smaller grant that is less aligned with their project.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q2.2" value="c" id="q2.2c"><label for="q2.2c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) Deciding whether to apply for a grant with a short deadline or one with a long deadline.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q2.2" value="d" id="q2.2d"><label for="q2.2d" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">d) Deciding between a project that creates a measurable impact and one that aligns with global trends.</span></label></div>
                        </div>
                    </div>

                    <div class="mc-question" data-question-id="2.3" data-correct-answer="c">
                        <p class="mc-question-text">3. The text states that for Grant A, "we would have to tailor our proposal significantly." What does this imply about the NGO's project?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q2.3" value="a" id="q2.3a"><label for="q2.3a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) The project is not well-planned or developed yet.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q2.3" value="b" id="q2.3b"><label for="q2.3b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) The project is too ambitious for the $10,000 funding amount.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q2.3" value="c" id="q2.3c"><label for="q2.3c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) The project's primary focus is not on sustainable agriculture or local crafts.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q2.3" value="d" id="q2.3d"><label for="q2.3d" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">d) The project requires an international partner, which Grant A does not allow.</span></label></div>
                        </div>
                    </div>

                    <div class="mc-question" data-question-id="2.4" data-correct-answer="b">
                        <p class="mc-question-text">4. What can be inferred about the NGO's current project?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q2.4" value="a" id="q2.4a"><label for="q2.4a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) It is a local crafts initiative for the Nablus economy.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q2.4" value="b" id="q2.4b"><label for="q2.4b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) It is a digital skills initiative that aligns well with global trends.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q2.4" value="c" id="q2.4c"><label for="q2.4c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) It is a project that requires a partnership with a technical consultancy.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q2.4" value="d" id="q2.4d"><label for="q2.4d" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">d) It is a small-scale project that can be funded with less than $10,000.</span></label></div>
                        </div>
                    </div>
                </div>

                <div class="activity-card">
                    <h3>Activity 3: Analysis and Functional Language</h3>
                    <p class="instructions" style="text-align:left; font-style:normal;">Read the questions and choose the best answer based on the text and general professional communication.</p>
                    <div class="mc-question" data-question-id="3.1" data-correct-answer="b">
                        <p class="mc-question-text">1. An NGO in Nablus wants to start a new recycling program. Which term from the grant summaries best describes this program's goal of reducing waste by 20%?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q3.1" value="a" id="q3.1a"><label for="q3.1a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) Funding stream</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q3.1" value="b" id="q3.1b"><label for="q3.1b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) Measurable outcome</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q3.1" value="c" id="q3.1c"><label for="q3.1c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) Financial audit</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q3.1" value="d" id="q3.1d"><label for="q3.1d" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">d) Administrative burden</span></label></div>
                        </div>
                    </div>
                    <div class="mc-question" data-question-id="3.2" data-correct-answer="c">
                        <p class="mc-question-text">2. The text says a partnership "might strengthen the application" for Grant B. What does this phrase do?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q3.2" value="a" id="q3.2a"><label for="q3.2a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) It gives a command that a partnership is required.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q3.2" value="b" id="q3.2b"><label for="q3.2b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) It guarantees that a partnership will ensure success.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q3.2" value="c" id="q3.2c"><label for="q3.2c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) It speculates about a potential positive factor.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q3.2" value="d" id="q3.2d"><label for="q3.2d" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">d) It states a definite fact about the application process.</span></label></div>
                        </div>
                    </div>
                    <div class="mc-question" data-question-id="3.3" data-correct-answer="a">
                        <p class="mc-question-text">3. According to the text, what is the 'rationale' for a project applying for Grant B?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q3.3" value="a" id="q3.3a"><label for="q3.3a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) The reason or justification for the project.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q3.3" value="b" id="q3.3b"><label for="q3.3b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) The list of equipment to be purchased.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q3.3" value="c" id="q3.3c"><label for="q3.3c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) The schedule of project activities.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q3.3" value="d" id="q3.3d"><label for="q3.3d" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">d) The names of the project team members.</span></label></div>
                        </div>
                    </div>
                    <div class="mc-question" data-question-id="3.4" data-correct-answer="c">
                        <p class="mc-question-text">4. Imagine you are on a video call with the Digital Futures Foundation. Which of the following is the most polite way to ask about the reporting requirements?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q3.4" value="a" id="q3.4a"><label for="q3.4a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) What are the reporting requirements?</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q3.4" value="b" id="q3.4b"><label for="q3.4b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) Tell me the reporting requirements now.</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q3.4" value="c" id="q3.4c"><label for="q3.4c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) Could you tell us a bit more about the reporting requirements?</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q3.4" value="d" id="q3.4d"><label for="q3.4d" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">d) I need to know the reporting requirements.</span></label></div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="assessment-section">
                <h2>C: Vocabulary</h2>
                <div class="activity-card" data-activity-type="matching">
                    <h3>Activity 4: Matching Key Terms</h3>
                    <p class="instructions" style="text-align:left; font-style:normal;">Match the vocabulary words with their correct definitions.</p>
                    <div class="matching-container">
                        <div class="matching-column">
                            <h4>Column A (Words)</h4>
                            <ul id="match-col-a">
                                <li data-match-id="1">1. Stakeholder</li>
                                <li data-match-id="2">2. Synergy</li>
                                <li data-match-id="3">3. Deliverable</li>
                                <li data-match-id="4">4. Methodology</li>
                                <li data-match-id="5">5. Mutual benefit</li>
                                <li data-match-id="6">6. Carbon footprint</li>
                            </ul>
                        </div>
                        <div class="matching-column">
                            <h4>Column B (Definitions)</h4>
                            <ul id="match-col-b">
                                <li data-match-id="3">a) A specific product or result that a project promises to create (e.g., a report, a workshop).</li>
                                <li data-match-id="4">b) The system of methods and principles used for a particular activity (e.g., how you will run the project).</li>
                                <li data-match-id="5">c) An advantage that is good for both parties in a partnership.</li>
                                <li data-match-id="1">d) A person, group, or organization that has an interest or concern in a project.</li>
                                <li data-match-id="6">e) The total amount of greenhouse gases generated by our actions.</li>
                                <li data-match-id="2">f) When two groups work together to create a result that is greater than their individual efforts.</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="activity-card">
                    <h3>Activity 5: Vocabulary in Context</h3>
                    <p class="instructions" style="text-align:left; font-style:normal;">Complete the sentences by choosing the correct word from the dropdown list.</p>
                    <div class="dropdown-question" data-correct-answer="assessment">1. Before starting the project, we must conduct a full impact <select name="q5.1"><option value="">--</option><option>assessment</option><option>objective</option><option>timeline</option></select> to understand the potential effects.</div>
                    <div class="dropdown-question" data-correct-answer="joint venture">2. The two NGOs decided to form a <select name="q5.2"><option value="">--</option><option>joint venture</option><option>donor relation</option><option>measurable outcome</option></select> to apply for the grant together.</div>
                    <div class="dropdown-question" data-correct-answer="with">3. For the project to be successful, we need to consult <select name="q5.3"><option value="">--</option><option>with</option><option>at</option><option>for</option></select> all key community leaders.</div>
                    <div class="dropdown-question" data-correct-answer="sustainability">4. The long-term <select name="q5.4"><option value="">--</option><option>sustainability</option><option>watershed</option><option>MoU</option></select> of the project depends on community involvement, not just external funding.</div>
                    <div class="dropdown-question" data-correct-answer="in">5. The project resulted <select name="q5.5"><option value="">--</option><option>in</option><option>on</option><option>of</option></select> a 15% increase in youth employment in the technology sector.</div>
                </div>
            </section>
            
            <section class="assessment-section">
                <h2>D: Grammar</h2>
                <div class="activity-card">
                    <h3>Activity 6: Review of Past Tenses</h3>
                    <p class="instructions" style="text-align:left; font-style:normal;">Read the summary of a project's background. Choose the correct verb form for each gap.</p>
                    <div class="dropdown-question" data-correct-answer="came out">1. The initial report, which <select name="q6.1"><option value="">--</option><option>came out</option><option>was coming out</option></select> in 2022, showed a clear need for water conservation in the Hebron area.</div>
                    <div class="dropdown-question" data-correct-answer="had already started">2. By the time we launched our campaign in May, the municipality <select name="q6.2"><option value="">--</option><option>already started</option><option>had already started</option></select> its own awareness program.</div>
                    <div class="dropdown-question" data-correct-answer="was conducting">3. While our team <select name="q6.3"><option value="">--</option><option>was conducting</option><option>conducted</option></select> interviews with farmers, the project manager secured additional funding.</div>
                    <div class="dropdown-question" data-correct-answer="hadn't improved">4. The final evaluation demonstrated that the community's water usage <select name="q6.4"><option value="">--</option><option>didn't improve</option><option>hadn't improved</option></select> as much as we had hoped in the first year.</div>
                </div>

                <div class="activity-card">
                    <h3>Activity 7: Modals of Speculation</h3>
                    <p class="instructions" style="text-align:left; font-style:normal;">Read the dialogue about a potential partnership. Choose the best modal verb to complete the sentences.</p>
                    <div class="dropdown-question" data-correct-answer="might">1. Nadia: With your technical expertise and our community network, we <select name="q7.1"><option value="">--</option><option>must</option><option>might</option></select> create a very strong proposal for the grant.</div>
                    <div class="dropdown-question" data-correct-answer="could">2. Karim: That's interesting. A joint awareness campaign <select name="q7.2"><option value="">--</option><option>could</option><option>must</option></select> also be very effective in reaching a wider audience.</div>
                    <div class="dropdown-question" data-correct-answer="may">3. Nadia: If the first project works well, we <select name="q7.3"><option value="">--</option><option>may</option><option>will</option></select> even be able to sign a longer-term memorandum of understanding.</div>
                    <div class="dropdown-question" data-correct-answer="could">4. Karim: I agree. This partnership <select name="q7.4"><option value="">--</option><option>could</option><option>will</option></select> be the start of a very successful long-term collaboration between Amman and Nablus.</div>
                </div>
                
                <div class="activity-card">
                    <h3>Activity 8: Second Conditional</h3>
                    <p class="instructions" style="text-align:left; font-style:normal;">Read the sentences from a strategy meeting. Choose the option that correctly completes the second conditional sentence.</p>
                    <div class="mc-question" data-question-id="8.1" data-correct-answer="b">
                        <p class="mc-question-text">1. If we had a bigger budget for the project, we __________ a full-time communications officer.</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q8.1" value="a" id="q8.1a"><label for="q8.1a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) will hire</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q8.1" value="b" id="q8.1b"><label for="q8.1b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) would hire</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q8.1" value="c" id="q8.1c"><label for="q8.1c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) hired</span></label></div>
                        </div>
                    </div>
                    <div class="mc-question" data-question-id="8.2" data-correct-answer="a">
                        <p class="mc-question-text">2. We would have a greater impact if we __________ with a local university.</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q8.2" value="a" id="q8.2a"><label for="q8.2a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) partnered</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q8.2" value="b" id="q8.2b"><label for="q8.2b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) would partner</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q8.2" value="c" id="q8.2c"><label for="q8.2c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) will partner</span></label></div>
                        </div>
                    </div>
                    <div class="mc-question" data-question-id="8.3" data-correct-answer="c">
                        <p class="mc-question-text">3. If the donor __________ for a full financial audit, we would need to hire an external accountant.</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q8.3" value="a" id="q8.3a"><label for="q8.3a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) would ask</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q8.3" value="b" id="q8.3b"><label for="q8.3b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) will ask</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q8.3" value="c" id="q8.3c"><label for="q8.3c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) asked</span></label></div>
                        </div>
                    </div>
                    <div class="mc-question" data-question-id="8.4" data-correct-answer="a">
                        <p class="mc-question-text">4. What __________ if the municipal council rejected our proposal?</p>
                        <div class="mc-options-container">
                            <div class="mc-option-item"><input type="radio" name="q8.4" value="a" id="q8.4a"><label for="q8.4a" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">a) would you do</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q8.4" value="b" id="q8.4b"><label for="q8.4b" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">b) will you do</span></label></div>
                            <div class="mc-option-item"><input type="radio" name="q8.4" value="c" id="q8.4c"><label for="q8.4c" class="mc-option-label"><span class="option-control"></span><span class="mc-option-text">c) did you do</span></label></div>
                        </div>
                    </div>
                </div>
                
                <div class="activity-card">
                    <h3>Activity 9: Clauses of Purpose and Reason</h3>
                    <p class="instructions" style="text-align:left; font-style:normal;">Complete the sentences from a project proposal by choosing the correct word or phrase.</p>
                    <div class="dropdown-question" data-correct-answer="because">1. We are launching this program <select name="q9.1"><option value="">--</option><option>so that</option><option>because</option></select> we want to provide young people with valuable digital skills.</div>
                    <div class="dropdown-question" data-correct-answer="in order to">2. We will hold weekly workshops <select name="q9.2"><option value="">--</option><option>due to</option><option>in order to</option></select> give participants hands-on experience.</div>
                    <div class="dropdown-question" data-correct-answer="so that">3. A detailed timeline is included <select name="q9.3"><option value="">--</option><option>so that</option><option>because of</option></select> the donor can clearly see our project plan and key milestones.</div>
                    <div class="dropdown-question" data-correct-answer="due to">4. The project was delayed <select name="q9.4"><option value="">--</option><option>due to</option><option>to</option></select> unforeseen administrative challenges.</div>
                </div>
            </section>

            <div id="submission-area">
                <button id="submit-assessment-btn" class="activity-btn">Submit Final Assessment</button>
            </div>
            <div id="submission-feedback"></div>
        </main>
    </div>

    <script>
    (function() {
        'use strict';
        const DURATION = 60 * 60; // 60 minutes
        let timeRemaining = DURATION;
        let timerInterval = null;
        let studentId = '';
        let assessmentSubmitted = false;
        
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwI1FuQM8gdwTSvU3FXVB7eX7EFoJCTWj0njCu2I6ibzCq2PtGQg_raW2gpocIVUuOviw/exec';

        const studentIdModal = document.getElementById('student-id-modal');
        const studentIdInput = document.getElementById('student-id-input');
        const startBtn = document.getElementById('start-assessment-btn');
        const assessmentContainer = document.querySelector('.assessment-container');
        const timerDisplay = document.getElementById('countdown-timer');
        const submitBtn = document.getElementById('submit-assessment-btn');

        // Step 1: Student Identification
        studentIdInput.addEventListener('input', () => {
            startBtn.disabled = !/^\d+$/.test(studentIdInput.value.trim());
        });
        startBtn.addEventListener('click', () => {
            studentId = studentIdInput.value.trim();
            studentIdModal.style.display = 'none';
            assessmentContainer.style.display = 'block';
            startTimer();
        });

        // Step 2: Timer Logic
        function startTimer() {
            timerInterval = setInterval(() => {
                timeRemaining--;
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                timerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = '00:00';
                    handleSubmission(true); // Auto-submit
                }
            }, 1000);
        }

        // Step 3: Question Locking Logic
        document.querySelectorAll('.mc-options-container input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', e => {
                const container = e.target.closest('.mc-options-container');
                container.querySelectorAll('input[type="radio"]').forEach(input => {
                    input.disabled = true;
                    input.nextElementSibling.classList.add('locked');
                });
            });
        });
        
        document.querySelectorAll('.dropdown-question select').forEach(select => {
            select.addEventListener('change', e => { e.target.disabled = true; });
        });

        // Matching Activity Logic
        let selectedMatchItem = null;
        const matchingActivities = document.querySelectorAll('[data-activity-type="matching"]');
        matchingActivities.forEach(activity => { activity.dataset.matchCounter = 1; });
        document.querySelectorAll('.matching-column li').forEach(item => {
            item.addEventListener('click', e => {
                if (assessmentSubmitted || e.currentTarget.style.pointerEvents === 'none') return;
                const currentItem = e.currentTarget;
                const currentColumn = currentItem.closest('.matching-column');
                if (currentItem.classList.contains('selected')) {
                    currentItem.classList.remove('selected');
                    selectedMatchItem = null;
                    return;
                }
                if (!selectedMatchItem) {
                    currentColumn.parentElement.querySelectorAll('li').forEach(li => li.classList.remove('selected'));
                    currentItem.classList.add('selected');
                    selectedMatchItem = currentItem;
                } else if (selectedMatchItem.closest('.matching-column') !== currentColumn) {
                    selectedMatchItem.dataset.userMatch = currentItem.dataset.matchId;
                    currentItem.dataset.userMatch = selectedMatchItem.dataset.matchId;
                    const activityCard = currentItem.closest('[data-activity-type="matching"]');
                    const matchNumber = activityCard.dataset.matchCounter;
                    const matchClass = `matched-pair-${matchNumber}`;
                    selectedMatchItem.classList.add(matchClass);
                    currentItem.classList.add(matchClass);
                    selectedMatchItem.style.pointerEvents = 'none';
                    currentItem.style.pointerEvents = 'none';
                    selectedMatchItem.classList.remove('selected');
                    activityCard.dataset.matchCounter = Math.min(6, parseInt(matchNumber, 10) + 1);
                    selectedMatchItem = null;
                }
            });
        });

        // Step 4: Submission Handling
        submitBtn.addEventListener('click', () => handleSubmission(false));
        
        function handleSubmission(isAutoSubmit) {
            if (assessmentSubmitted) return;
            assessmentSubmitted = true;
            clearInterval(timerInterval);

            if (!isAutoSubmit) {
                if (!confirm('Are you sure you want to submit your assessment?')) {
                    assessmentSubmitted = false;
                    startTimer(); // Resume timer if they cancel
                    return;
                }
            }

            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';

            const score = calculateScore();
            const total = calculateTotalPoints();
            
            showFeedback(score, total);
            submitToGoogleSheet(studentId, 'B2', `${score}/${total}`);
        }

        function calculateScore() {
            let score = 0;
            // MCQs (Activities 1, 2, 3, 8)
            document.querySelectorAll('.mc-question[data-correct-answer]').forEach(q => { if (q.querySelector('input:checked')?.value === q.dataset.correctAnswer) score++; });
            // Dropdowns (Activities 5, 6, 7, 9)
            document.querySelectorAll('.dropdown-question').forEach(q => { if (q.querySelector('select').value === q.dataset.correctAnswer) score++; });
            // Matching (Activity 4)
            document.querySelectorAll('#match-col-a li').forEach(item => { if (item.dataset.userMatch && item.dataset.matchId === item.dataset.userMatch) score++; });

            return score;
        }

        function calculateTotalPoints() {
            const mcCount = document.querySelectorAll('.mc-question[data-correct-answer]').length;
            const dropdownCount = document.querySelectorAll('.dropdown-question[data-correct-answer]').length;
            const matchingCount = document.querySelectorAll('#match-col-a li').length;
            return mcCount + dropdownCount + matchingCount;
        }

        function submitToGoogleSheet(id, level, finalScore) {
            const formData = new FormData();
            formData.append('Student ID', id);
            formData.append('Level', level);
            formData.append('Score', finalScore);

            fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: formData, mode: 'no-cors' })
            .then(() => {
                console.log('Success: Submission data sent.');
                document.getElementById('submission-feedback').innerHTML += `<p>Your results have been successfully recorded.</p>`;
            })
            .catch(error => {
                console.error('Submission Error:', error);
                const feedbackEl = document.getElementById('submission-feedback');
                feedbackEl.classList.remove('success');
                feedbackEl.classList.add('error');
                feedbackEl.innerHTML += `<p>There was an error saving your results. Please contact your teacher.</p>`;
            });
        }
        
        function showFeedback(score, total) {
            const feedbackEl = document.getElementById('submission-feedback');
            feedbackEl.style.display = 'block';
            feedbackEl.classList.add('success');
            feedbackEl.innerHTML = `<h2>Assessment Complete!</h2><p>Your score is <strong>${score} / ${total}</strong>.</p>`;
            
            // MCQ Feedback
            document.querySelectorAll('.mc-question[data-correct-answer]').forEach(q => {
                q.querySelectorAll('.mc-option-item').forEach(item => {
                    const radio = item.querySelector('input');
                    const label = item.querySelector('label');
                    if (radio.value === q.dataset.correctAnswer) {
                        label.classList.add('feedback-correct');
                    } else if (radio.checked) {
                        label.classList.add('feedback-incorrect');
                    }
                });
            });

            // Dropdown Feedback
            document.querySelectorAll('.dropdown-question[data-correct-answer]').forEach(q => {
                const select = q.querySelector('select');
                if (select.value === q.dataset.correctAnswer) {
                    select.classList.add('feedback-correct');
                } else {
                    select.classList.add('feedback-incorrect');
                    const correctAnswerSpan = document.createElement('span');
                    correctAnswerSpan.className = 'correct-answer-text';
                    correctAnswerSpan.textContent = `(Correct: ${q.dataset.correctAnswer})`;
                    q.appendChild(correctAnswerSpan);
                }
            });

            // Matching Feedback
            document.querySelectorAll('#match-col-a li').forEach(item => {
                if (item.dataset.userMatch && item.dataset.matchId === item.dataset.userMatch) {
                    item.classList.add('feedback-correct');
                    document.querySelector(`#match-col-b li[data-match-id='${item.dataset.userMatch}']`).classList.add('feedback-correct');
                } else if (item.dataset.userMatch) {
                    item.classList.add('feedback-incorrect');
                    document.querySelector(`#match-col-b li[data-match-id='${item.dataset.userMatch}']`).classList.add('feedback-incorrect');
                }
            });

            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        }
    })();
    </script>
</body>
</html>
